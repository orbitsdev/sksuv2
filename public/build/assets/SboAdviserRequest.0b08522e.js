import{_ as R,x as u,g as m,w as r,r as c,o as n,d as l,e as f,t as h,k as C,c as a,h as b,v as T,b as i,F as v,i as x,z as V,T as _}from"./app.a30414ce.js";const D={created(){this.loadUser(),this.loadSchool()},data(){return{showConfirm:!1,showForm:!1,search:"",users:[],isFetching:!1,isSchoolFetching:!1,isConfirming:!1,filterBy:"none",selectedRequest:[],selectedUser:null,schools:[],requestError:null}},watch:{search(s,t){this.searchUser()}},methods:{showTheForm(){this.showForm=!0},closeTheForm(){this.showForm=!1},closeErrorDialog(){this.requestError=null},async confirmSelectedRequest(){const s=[];this.selectedRequest.forEach(t=>{s.push(t.id)}),this.isConfirming=!0,u.post("api/sbo-requests/confirm-selected-request",{userid:s}).then(t=>{console.log(t.data),this.loadUser(),this.showForm=!1,this.selectedRequest=[]}).catch(t=>{this.requestError=t}).finally(()=>{this.isConfirming=!1})},showConfirmation(s){this.selectedUser=s,this.showConfirm=!0},async confirmRequest(s){this.isConfirming=!0,u.post("api/sbo-requests/confirm",{id:this.selectedUser.id}).then(t=>{console.log(t.data),this.showConfirm=!1,this.selectedUser=null,this.loadUser()}).catch(t=>{this.requestError=t}).finally(()=>{this.isConfirming=!1})},async filterUser(){await u.post("api/current-sbo-advisers/filter",{filter:this.filterBy}).then(s=>{this.users=s.data.data}).catch(s=>{this.requestError=s})},async searchUser(){await u.post("api/sbo-requests/search",{search:this.search,filter:this.filterBy}).then(s=>{this.users=s.data.data})},async loadSchool(){this.isSchoolFetching=!0,await u.get("api/schools").then(s=>{this.schools=s.data.data,this.schools.length>0}).catch(s=>{this.requestError=s}).finally(()=>{this.isSchoolFetching=!1})},async loadUser(){this.isFetching=!0,await u.get("api/sbo-requests").then(s=>{console.log(s),this.users=s.data.data}).catch(s=>{console.log(s),this.requestError=s}).finally(()=>{this.isFetching=!1})}}},N={key:0},A={key:1},I=i("option",{value:"none"}," None",-1),j=["value"],M={class:"relative w-12 px-6 sm:w-16 sm:px-8"},Y=["value"],z={class:"whitespace-nowrap py-4 text-sm"},L={class:"flex items-center"},G={class:"pl-1"},H={class:"font-medium text-sm text-gray-900"},J={class:"whitespace-nowrap px-3 py-4 text-sm text-gray-500"},K={key:0},O={key:1},P=i("span",null,[i("span",{class:"inline-flex rounded-full bg-green-100 px-2 text-xs font-semibold leading-5 text-green-800"},"None")],-1),Q=[P],W={class:"whitespace-nowrap px-3 py-4 text-sm text-gray-500"},X={key:0},Z={class:"relative whitespace-nowrap py-4 pl-3 pr-4 text-right text-sm font-medium sm:pr-6"},$=["disabled","onClick"],ee=f(" Yes "),se={class:"bg-gray-100 text-xs italic p-1 my-1 rounded-sm"},te={key:0},oe={key:1},re=f(" Yes ");function ne(s,t,ie,le,e,d){const p=c("TableButton"),q=c("BaseSearchInput"),k=c("BaseSpinner"),B=c("BaseTableSetup"),S=c("BaseTable"),U=c("RequestError"),F=c("BaseErrorDialog"),g=c("BaseConfirmation"),y=c("BaseDialog"),E=c("BaseCard");return n(),m(E,{subtitle:"Request From Users"},{header:r(()=>[l(B,null,{"searchs-area":r(()=>[e.selectedRequest.length>0?(n(),m(p,{key:0,class:"mr-2",onClick:d.showTheForm},{default:r(()=>[f(" Confirm selected ("+h(e.selectedRequest.length)+") ",1)]),_:1},8,["onClick"])):C("",!0),l(q,{placeholder:"Search Name ...",modelValue:e.search,"onUpdate:modelValue":t[0]||(t[0]=o=>e.search=o)},null,8,["placeholder","modelValue"])]),"filters-area":r(()=>[e.isSchoolFetching?(n(),a("div",N,[l(k)])):(n(),a("div",A,[b(i("select",{"onUpdate:modelValue":t[1]||(t[1]=o=>e.filterBy=o),onChange:t[2]||(t[2]=(...o)=>d.filterUser&&d.filterUser(...o)),class:"block hover:shadow-lg border px-3 py-2 text-gray-600 placeholder-gray-500 focus:border-gray-300 focus:placeholder-gray-400 focus:outline-none sm:text-sm"},[I,(n(!0),a(v,null,x(e.schools,o=>(n(),a("option",{key:o.id,class:"py-2",value:o.name},h(o.name),9,j))),128))],544),[[T,e.filterBy]])]))]),"actions-area":r(()=>[]),_:1}),l(S,{thdata:["","Name","University","status",""],isFetching:e.isFetching},{data:r(()=>[(n(!0),a(v,null,x(e.users,o=>(n(),a("tr",{key:o.id},[i("td",M,[b(i("input",{"onUpdate:modelValue":t[3]||(t[3]=w=>e.selectedRequest=w),value:o,type:"checkbox",class:"absolute left-4 top-1/2 -mt-2 h-4 w-4 rounded border-gray-300 text-indigo-600 focus:ring-indigo-500 sm:left-6"},null,8,Y),[[V,e.selectedRequest]])]),i("td",z,[i("div",L,[i("div",G,[i("div",H,h(o.first_name)+" "+h(o.last_name),1)])])]),i("td",J,[o.schools.length>0?(n(),a("div",K,[i("span",null,h(o.schools[0].name),1)])):(n(),a("div",O,Q))]),i("td",W,[o.sbo_request!=null?(n(),a("div",X,h(o.sbo_request.status),1)):C("",!0)]),i("td",Z,[i("button",{disabled:e.selectedRequest.length>0,onClick:w=>d.showConfirmation(o),type:"button",class:"inline-flex items-center rounded-md border outline:none border-gray-300 bg-white px-3 py-2 text-sm font-medium leading-4 text-gray-700 shadow-sm hover:bg-gray-50 focus:outline-none focus:ring-1 disabled:cursor-not-allowed disabled:opacity-30 mr-1"}," Confirm ",8,$)])]))),128))]),_:1},8,["isFetching"])]),default:r(()=>[(n(),m(_,{to:"#app"},[l(F,{show:e.requestError!=null,width:"400",transition:"slide-fade-down"},{"c-content":r(()=>[l(U,{statusCode:e.requestError.statusCode,onClose:d.closeErrorDialog,message:e.requestError.message},null,8,["statusCode","onClose","message"])]),"c-actions":r(()=>[]),_:1},8,["show"])])),(n(),m(_,{to:"#app"},[l(y,{show:e.showForm,width:"500",preventClose:!0},{"c-content":r(()=>[l(g,{selectedData:e.selectedRequest,onClose:d.closeTheForm,isSaving:s.isSaving,title:"Are your sure do you want to make this users as ",subject:"Sbo-Adviser"},{default:r(()=>[l(p,{class:"mr-2",onClick:d.confirmSelectedRequest},{default:r(()=>[ee]),_:1},8,["onClick"])]),_:1},8,["selectedData","onClose","isSaving"])]),_:1},8,["show"])])),(n(),m(_,{to:"#app"},[l(y,{show:e.showConfirm,width:"500",preventClose:!0},{"c-content":r(()=>[l(g,{onClose:t[4]||(t[4]=o=>e.showConfirm=!1),isSaving:e.isConfirming,title:"Are your sure do you want to make this users as ",subject:"Sbo-Adviser"},{data:r(()=>[i("div",se,[f(h(e.selectedUser.first_name)+" "+h(e.selectedUser.last_name)+" - ",1),e.selectedUser.schools!=null&&e.selectedUser.schools.length>0?(n(),a("span",te,h(e.selectedUser.schools[0].name),1)):(n(),a("span",oe," Unknown "))])]),default:r(()=>[l(p,{class:"mr-2",onClick:d.confirmRequest},{default:r(()=>[re]),_:1},8,["onClick"])]),_:1},8,["isSaving"])]),_:1},8,["show"])]))]),_:1})}const ce=R(D,[["render",ne]]);export{ce as default};
