import{_ as q,x as d,g as h,w as i,r as c,o as a,d as r,c as n,k as I,i as f,b as l,h as y,z as R,t as m,e as u,F as v,T as k,v as S}from"./app.0b9d15e2.js";const O={created(){this.getAllCampusAdvisers(),this.getAllSchoolYears(),this.getUsers()},data(){return{filterBy:"none",showForm:!1,search:"",sboadvisers:[],selectedSboAdvisers:[],requestError:null,isFetching:!1,isSchooLoading:!1,isSaving:!1,requestError:null,showMainForm:!1,hasRequestError:null,campus_advisers:[],users:[],schools:[],school_years:[],selecated_campuse_adviser:null,selecated_school:null,selected_school_year:null,isSchoolYearFetching:!1,isAvailabeUserFetching:!1,isSchoolFetching:!1,selectedAdvisers:[],selectedCampusAdviser:null,showDeleteConfirmation:!1,isDeleting:!1,isUpdatingMode:!1,hasWarning:null}},watch:{search(e,s){this.searchCampusAdviser()}},methods:{async updateCampusAdviser(){this.isSaving=!0;let e={id:this.selectedCampusAdviser.id,user_id:this.selecated_campuse_adviser,school_id:this.selecated_school,school_year_id:this.selected_school_year};console.log(e),await d.post("api/campus/campus-adviser/update",e).then(s=>{this.showMainForm=!1,this.isUpdatingMode=!1,this.selectedCampusAdviser=null,this.selecated_campuse_adviser=null,this.school_id=null,this.getAllCampusAdvisers(),this.getUsers()}).catch(s=>{this.hasRequestError='"Oops! It seems like there was an error when updating campuse adviser Please check your network connection. o and try again. if you think it it was the system please do contact the developer"'}).finally(()=>{this.isSaving=!1})},changeHandler(e){let s=this.school_years.find(g=>g.id==e.target.value);this.schools=s.schools,this.selecated_school=null,this.schools.length>0&&(this.selecated_school=this.schools[0].id)},chnageSchoolData(){},handleCloseForm(){this.selectedCampusAdviser=null,this.isUpdatingMode=!1,this.showMainForm=!1},selectCampusAdviser(e){this.selectedCampusAdviser=e,this.isUpdatingMode=!0,console.log(e),this.selected_school_year=e.school_year.id,e.school!=null&&(this.selecated_school=e.school.id),this.showMainForm=!0},async deleteSelectedCampusAdviser(){this.isDeleting=!0,await d.post("api/campus/delete-selected",{campus_advisers_id:this.selectedAdvisers}).then(e=>{console.log(e),this.showDeleteConfirmation=!1,this.selectedAdvisers=[],this.getAllCampusAdvisers(),this.getUsers()}).catch(e=>{this.hasRequestError="Oops! It seems like there was an error when  when deleting campus advisers. if you think it it was the system please do contact the developer"}).finally(()=>{this.isDeleting=!1})},async getAllCampusAdvisers(){this.isFetching=!0,await d.get("api/campus/campus-advisers").then(e=>{this.campus_advisers=e.data.data}).catch(e=>{this.hasRequestError="Oops! It seems like there was an error when  fetchin  campus advisers, Please check your network connection. o and try again. if you think it it was the system please do contact the developer"}).finally(()=>{this.isFetching=!1})},async getAllSchoolYears(){this.isSchoolYearFetching=!0,await d.get("api/school-year-with-schools").then(e=>{this.school_years=e.data.data,this.school_years.length>0&&(this.selected_school_year=this.school_years[0].id,this.schools=this.school_years[0].schools,this.schools.length>0&&(this.selecated_school=this.schools[0].id))}).catch(e=>{this.hasRequestError='"Oops! It seems like there was an error when  fetchin information school year, Please check your network connection. o and try again. if you think it it was the system please do contact the developer'}).finally(()=>{this.isSchoolYearFetching=!1})},async loadSchool(){this.isSchoolFetching=!0,await d.get("api/schools").then(e=>{this.schools=e.data.data,this.schools.length>0&&(this.selecated_school=this.schools[0].id)}).catch(e=>{this.hasRequestError='"Oops! It seems like there was an error when fetching schools. o and try again. if you think it it was the system please do contact the developer'}).finally(()=>{this.isSchoolFetching=!1})},async getUsers(){this.isAvailabeUserFetching=!0,await d.get("api/available-users").then(e=>{this.users=e.data.data,this.users.length>0&&(this.selecated_campuse_adviser=this.users[0].id)}).catch(e=>{this.hasRequestError='"Oops! It seems like there was an error when fetching avvalabe users. o and try again. if you think it it was the system please do contact the developer'}).finally(()=>{this.isAvailabeUserFetching=!1})},async addCampusAdviser(){this.isSaving=!0;let e={user_id:this.selecated_campuse_adviser,school_id:this.selecated_school,school_year_id:this.selected_school_year};console.log(e),await d.post("api/campus/campus-adviser",e).then(s=>{console.log(s.data),s.data.data===1?this.hasWarning='" You can only set one user Per School in each school year "':(this.showMainForm=!1,this.getAllSchoolYears(),this.getAllCampusAdvisers(),this.getUsers())}).catch(s=>{this.hasRequestError='"Oops! It seems like there was an error when adding campuse adviser Please check your network connection. o and try again. if you think it it was the system please do contact the developer'}).finally(()=>{this.isSaving=!1})},closeTheForm(){this.showForm=!1},showTheForm(){this.showForm=!0},async makeUsersAsSboAdviser(){const e=[];this.selectedSboAdvisers.forEach(s=>{e.push(s.id)}),this.isSaving=!0,await d.post("api/sbo-advisers/make-user-as-adviser",{usersid:e}).then(s=>{console.log(s.data.data),this.loadSboAdvisers(),this.showForm=!1,this.selectedSboAdvisers=[]}).catch(s=>{console.log(s)}).finally(()=>{this.isSaving=!1})},customConfirmationDialog({title:e="Are you sure?",text:s="You won't be able to revert this!",icon:g="warning",confirmButtonText:A="Yes, delete it!",passFunction:t,passCancelFunction:p}){this.$swal({title:e,text:s,icon:g,showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:A}).then(async _=>{_.isConfirmed&&t()})},async searchCampusAdviser(){d.post("api/campus/campus-adviser/search",{search:this.search}).then(e=>{this.campus_advisers=e.data.data})},async filterSbo(){await d.post("api/sbo-advisers/filter",{filter:this.filterBy}).then(e=>{this.sboadvisers=e.data.data}).catch(e=>{console.log(e)})},async loadSboAdvisers(){this.isFetching=!0,await d.get("api/sbo-advisers").then(e=>{this.sboadvisers=e.data.data}).catch(e=>{this.requestError=e}).finally(()=>{this.isFetching=!1})}}},N=l("i",{class:"fa-solid fa-plus mr-1"},null,-1),W=u(" ADD SBO-ADVISER "),P={key:0},G={key:1,class:"flex items-center"},j=l("i",{class:"fa-regular fa-trash-can mr-1"},null,-1),H=l("span",{class:"block"},"Delete Selected ",-1),L={class:"relative w-12 px-6 sm:w-16 sm:px-8"},z=["value"],J={class:"whitespace-nowrap px-3 py-4 text-sm text-green-700"},K={class:"font-semibold font-rubik"},Q={class:"whitespace-nowrap py-4"},X={class:"capitalize"},Z={class:"whitespace-nowrap py-4 text-sm text-gray-900"},$=u(" None "),ee=l("td",{class:"relative whitespace-nowrap py-4 pl-3 pr-4 text-right text-sm font-medium sm:pr-6"},null,-1),se=u(" Yes "),te={class:"mt-2"},oe=l("p",{class:"text-base font-bold"},"Select School Year",-1),ae=u(" Empty "),ie=["value"],le={class:"mt-2"},ne=l("p",{class:"text-base font-bold"},"Select University",-1),re=u("Empty "),ce=["value"],he={class:"mt-2"},de=l("p",{class:"text-base font-bold mt-4"},"Select User",-1),ue=u("Empty "),pe=["value"],me={class:"my-2 flex justify-end"},_e=u(" Close "),ge={key:0,class:"my-1 mx-2"},fe={key:1},ye={key:0},ve={key:1},we=u(" Update "),be=u(" Save "),Ce={key:0,class:"col-span-1 flex justify-center items-center"};function ke(e,s,g,A,t,p){const _=c("TableButton"),F=c("BaseSearchInput"),w=c("BaseSpinner"),B=c("BaseTableSetup"),x=c("StatusCard"),D=c("BaseTable"),U=c("BaseConfirmation"),b=c("BaseDialog"),C=c("NoDataCard"),E=c("ConfirmCard"),Y=c("GlobalErrorCard"),M=c("GlobalWarning"),T=c("BaseCard");return a(),h(T,{class:"relative",subtitle:"Campus SBO advisers"},{header:i(()=>[r(B,null,{"searchs-area":i(()=>[r(_,{class:"mr-2",onClick:s[0]||(s[0]=o=>t.showMainForm=!0)},{default:i(()=>[N,W]),_:1}),r(F,{placeholder:"Search name ..",modelValue:t.search,"onUpdate:modelValue":s[1]||(s[1]=o=>t.search=o)},null,8,["placeholder","modelValue"])]),"filters-area":i(()=>[t.isSchooLoading?(a(),n("div",P,[r(w)])):(a(),n("div",G))]),"actions-area":i(()=>[t.selectedAdvisers.length>0?(a(),h(_,{key:0,onClick:s[2]||(s[2]=o=>t.showDeleteConfirmation=!0),mode:""},{default:i(()=>[j,H]),_:1})):I("",!0)]),_:1})]),default:i(()=>[r(D,{thdata:["","Year","Sbo Adviser Name","University",""],isFetching:t.isFetching},{data:i(()=>[(a(!0),n(v,null,f(t.campus_advisers,o=>(a(),n("tr",{key:o.id},[l("td",L,[y(l("input",{"onUpdate:modelValue":s[3]||(s[3]=V=>t.selectedAdvisers=V),value:o.id,type:"checkbox",class:"absolute left-4 top-1/2 -mt-2 h-4 w-4 accent-green-600 text-white rounded border-gray-200 sm:left-6"},null,8,z),[[R,t.selectedAdvisers]])]),l("td",J,[l("p",K," SY."+m(o.school_year.from)+" - "+m(o.school_year.to),1)]),l("td",Q,[l("p",X,m(o.user.first_name+" "+o.user.last_name),1)]),l("td",Z,[o.school!=null?(a(),h(x,{key:0,class:"bg-green-700 text-white"},{default:i(()=>[u(m(o.school.name),1)]),_:2},1024)):(a(),h(x,{key:1,class:"bg-gray-700 text-white"},{default:i(()=>[$]),_:1}))]),ee]))),128))]),_:1},8,["isFetching"]),(a(),h(k,{to:"#app"},[r(b,{show:t.showForm,width:"500",preventClose:!0},{"c-content":i(()=>[r(U,{selectedData:t.selectedSboAdvisers,onClose:p.closeTheForm,isSaving:t.isSaving,title:"Are your sure do you want to make this users as",subject:"Sbo-Adviser"},{default:i(()=>[r(_,{class:"mr-2",onClick:p.makeUsersAsSboAdviser},{default:i(()=>[se]),_:1},8,["onClick"])]),_:1},8,["selectedData","onClose","isSaving"])]),_:1},8,["show"])])),(a(),h(k,{to:"#app"},[r(b,{show:t.showMainForm,width:"500",preventClose:!0},{"c-content":i(()=>[l("section",te,[l("div",null,[oe,t.school_years.length<=0?(a(),h(C,{key:0},{default:i(()=>[ae]),_:1})):y((a(),n("select",{key:1,onChange:s[4]||(s[4]=(...o)=>p.changeHandler&&p.changeHandler(...o)),"onUpdate:modelValue":s[5]||(s[5]=o=>t.selected_school_year=o),class:"block w-full py-2 px-3 pr-8 rounded-md bg-white border border-gray-400 focus:outline-none focus:shadow-outline-green focus:border-green-500 sm:text-sm sm:leading-5"},[(a(!0),n(v,null,f(t.school_years,o=>(a(),n("option",{key:o.id,value:o.id}," SY. "+m(o.from)+" - "+m(o.to),9,ie))),128))],544)),[[S,t.selected_school_year]])])]),l("section",le,[l("div",null,[ne,t.schools.length<=0?(a(),h(C,{key:0},{default:i(()=>[re]),_:1})):y((a(),n("select",{key:1,"onUpdate:modelValue":s[6]||(s[6]=o=>t.selecated_school=o),class:"block w-full py-2 px-3 pr-8 rounded-md bg-white border border-gray-400 focus:outline-none focus:shadow-outline-green focus:border-green-500 sm:text-sm sm:leading-5"},[(a(!0),n(v,null,f(t.schools,o=>(a(),n("option",{key:o.id,value:o.id},m(o.name),9,ce))),128))],512)),[[S,t.selecated_school]])])]),l("section",he,[l("div",null,[de,t.users.length<=0?(a(),h(C,{key:0},{default:i(()=>[ue]),_:1})):y((a(),n("select",{key:1,"onUpdate:modelValue":s[7]||(s[7]=o=>t.selecated_campuse_adviser=o),class:"block w-full py-2 px-3 pr-8 rounded-md bg-white border border-gray-400 focus:outline-none focus:shadow-outline-green focus:border-green-500 sm:text-sm sm:leading-5"},[(a(!0),n(v,null,f(t.users,o=>(a(),n("option",{key:o.id,value:o.id},m(o.first_name)+" "+m(o.last_name),9,pe))),128))],512)),[[S,t.selecated_campuse_adviser]])])]),l("div",me,[r(_,{mode:"",class:"mr-2",onClick:p.handleCloseForm},{default:i(()=>[_e]),_:1},8,["onClick"]),t.isSaving?(a(),n("div",ge,[r(w)])):(a(),n("div",fe,[t.selecated_campuse_adviser==null||t.selecated_school==null||t.selected_school_year==null?(a(),n("div",ye)):(a(),n("div",ve,[t.isUpdatingMode?(a(),h(_,{key:0,class:"",onClick:p.updateCampusAdviser},{default:i(()=>[we]),_:1},8,["onClick"])):(a(),h(_,{key:1,class:"",onClick:p.addCampusAdviser},{default:i(()=>[be]),_:1},8,["onClick"]))]))]))])]),_:1},8,["show"])])),(a(),h(k,{to:"#app"},[r(b,{show:t.showDeleteConfirmation,width:"600",preventClose:!0,class:"h-96"},{"c-content":i(()=>[r(E,{title:"Are you sure? Do you want to delete these Campus Advisers?",message:"Be mindful that deleting this data will also remove all associated informations. This action cannot be undone. Do you still wish to proceed?"},{default:i(()=>[t.isDeleting?(a(),n("div",Ce,[r(w)])):(a(),n("button",{key:1,onClick:s[8]||(s[8]=(...o)=>p.deleteSelectedCampusAdviser&&p.deleteSelectedCampusAdviser(...o)),class:"col-span-1 transition duration-150 ease-in-out hover:bg-red-600 bg-red-700 rounded text-white px-4 sm:px-8 py-2 text-xs sm:text-sm"}," Yes ")),l("button",{class:"col-span-1 ml-3 bg-gray-100 transition duration-150 text-gray-600 ease-in-out hover:border-gray-400 hover:bg-gray-300 border rounded px-8 py-2 text-sm",onClick:s[9]||(s[9]=o=>t.showDeleteConfirmation=!1)}," Close ")]),_:1},8,["message"])]),_:1},8,["show"])])),r(Y,{onClose:s[10]||(s[10]=o=>t.hasRequestError=null),show:t.hasRequestError!=null},null,8,["show"]),r(M,{onClose:s[11]||(s[11]=o=>t.hasWarning=null),show:t.hasWarning!=null},{default:i(()=>[u(m(t.hasWarning),1)]),_:1},8,["show"])]),_:1})}const Ae=q(O,[["render",ke]]);export{Ae as default};
