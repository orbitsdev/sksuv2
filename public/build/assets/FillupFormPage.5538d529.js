import{_ as D,s as I,x as g,c as o,d as y,b as r,t as p,g as b,w as F,h as u,v as w,F as m,i as f,k as d,r as _,o as t,A as k,e as S}from"./app.0b9d15e2.js";const L={computed:{...I(["fileType"])},data(){return{application:null,isFetching:!1,isSaving:!1,response:{application_id:null,fields_answer:[],requirements_files:[]},validationError:null,requestError:null,school_years:[],schools:[],selected_school:null,isSchoolFetching:!1}},props:{applicationId:{type:String},title:{type:String}},created(){this.getOfficersSchool(),this.getSpicificApplication()},methods:{async getAllSchoolYears(){this.isSchoolYearFetching=!0,await g.get("api/school-year-with-schools").then(i=>{this.school_years=i.data.data,this.school_years.length>0&&(this.selected_school_year=this.school_years[0].id,this.schools=this.school_years[0].schools,this.schools.length>0&&(this.selected_school=this.schools[0].id))}).catch(i=>{this.hasRequestError='"Oops! It seems like there was an error when  fetchin information school year, Please check your network connection. o and try again. if you think it it was the system please do contact the developer'}).finally(()=>{this.isSchoolYearFetching=!1})},async getOfficersSchool(){this.isSchoolFetching=!0,await g.get("api/application-form/get-school-of-officer").then(i=>{console.log(i.data.data),this.schools=i.data.data,this.schools.length>0&&(this.selected_school=this.schools[0].id)}).catch(i=>{this.hasRequestError='"Oops! It seems like there was an error when  fetchin information school information, Please check your network connection. o and try again. if you think it it was the system please do contact the developer'}).finally(()=>{this.isSchoolFetching=!1})},changeHandler(i){let s=this.school_years.find(l=>l.id==i.target.value);this.schools=s.schools,this.selected_school=null,this.schools.length>0&&(this.selected_school=this.schools[0].id)},async submitData(){this.isSaving=!0,this.response.fields_answer=[],this.response.requirements_files=[],this.application.fields.forEach(s=>{let l={field_id:s.id,name:s.name,type:s.type,answer:s.answer};this.response.fields_answer.push(l)}),this.application.requirements.forEach(s=>{let l={requirement_id:s.id,name:s.name,type:s.file_type,upload_type:s.upload_type,files:s.files};this.response.requirements_files.push(l)});let i={application_id:this.response.application_id,answers:this.response.fields_answer,requirements:this.response.requirements_files,school_year_id:this.selected_school_year,school_id:this.selected_school};g.post("api/application-form/response/create",i).then(s=>{this.validationError=null,console.log(s.data),this.$router.push({name:"monitor-app",params:{id:s.data.id}})}).catch(s=>{s.response.status===422?this.validationError=s.response.data.errors:this.requestError=s}).finally(()=>{this.isSaving=!1})},async fetchDataForSelect(i){axios.all(i.map(s=>axios.get("/api/application-fields-for-select/fetch",{params:s}))).then(s=>{this.application.fields.forEach(l=>{if(l.type=="select"){let c=s.find(n=>n.data.field_id==l.id);l.id==c.data.field_id&&(l.data=c.data.data,l.is_processing=!1,l.data.length>0&&(l.answer=l.data[0].id))}})}).catch(s=>{})},modifyFields(i){let s=[],l=[];return i.forEach(c=>{let n={...c,data:null,is_processing:!0,answer:null};if(c.type=="select"){let h={tablename:c.collection_for_select,field_id:c.id};l.push(h)}else n.is_processing=!1;s.push(n)}),{fields:s,request_parameters:l}},modifyRequirements(i){let s=[];return i.forEach((l,c)=>{let n={...l,files:[],isUploading:!1,handleLoading:h=>{this.application.requirements[c].isUploading=h},setFile:h=>{this.application.requirements[c].files.push(h)},removeFile:h=>{console.log(h);const v=h;this.application.requirements[c].files=this.application.requirements[c].files.filter(x=>x.folder!=v.folder)}};s.push(n)}),s},async getSpicificApplication(){this.isFetching=!0,await g.get("api/application-form/get-application",{params:{application_id:parseInt(this.applicationId)}}).then(i=>{let s=i.data.data;this.response.application_id=s.id;let l={...this.modifyFields(s.fields)};s.fields=l.fields,s.requirements=this.modifyRequirements(s.requirements),this.application=s,this.fetchDataForSelect(l.request_parameters)}).catch(i=>{console.log(i)}).finally(()=>{this.isFetching=!1})}}},T={key:0,class:"flex items-center justify-center h-96"},N={key:1,class:"bg-gray-200 p-4 shadow rounded-lg"},A={key:0},P={class:"mb-2 border-b-4 pb-2 border-gray-900 uppercase"},R={class:"text-2xl font-rubik font-semibold"},O={key:0,class:"px-3 bg-gray-300 pt-2 pb-4 rounded-lg mt-4"},Y=r("h1",{class:"text-lg font-bold font-rubik mb-2 uppercase"},"University",-1),j={class:"mt-2"},z=r("p",{class:"block font-rubik mb-1"},"Choose where to Send",-1),G=S("Empty "),M=["value"],H={key:1,class:"px-3 bg-gray-300 pt-2 pb-4 rounded-lg mt-4"},J=r("h1",{class:"text-lg font-bold font-rubik mb-2 uppercase"},"General Fields",-1),K={class:"grid grid-cols-2 gap-x-16 gap-y-6 mt-1 px-2"},Q=["for"],W=["id","onUpdate:modelValue"],X=["id","onUpdate:modelValue"],Z=["id","onUpdate:modelValue"],$=["id","onUpdate:modelValue"],ee={key:4,class:"relative rounded-md shadow-sm"},se={key:1},te=["id","onUpdate:modelValue"],oe=["value"],ae=["id","onUpdate:modelValue"],ie=["value"],le=["id","onUpdate:modelValue"],ne=["value"],re={key:0,class:"text-xs text-red-500 mt-1"},ce={key:2,class:"mt-4 px-3 bg-gray-300 pt-2 pb-4 rounded-lg"},de=r("h1",{class:"text-lg font-bold font-rubik mb-2 uppercase"},"Requirements",-1),pe={class:"grid grid-cols-4 gap-x-4 gap-y-1"},he=["for"],ue={class:"text-xs text-gray capitalize text-gray-500"},_e={class:"text-xs text-gray capitalize text-gray-500"},me={class:"mt-6"},fe={class:"my-2 flex justify-end items-center"},ge={class:"flex"},ye=S(" Back "),be=S(" Submit ");function we(i,s,l,c,n,h){const v=_("BackCard"),x=_("Loader1"),V=_("NoDataCard"),E=_("LinearLoader"),B=_("FilePondBase"),U=_("TableButton"),C=_("BaseSpinner");return t(),o("div",null,[y(v,{class:"mb-4",onClick:s[0]||(s[0]=e=>this.$router.back())}),n.isFetching?(t(),o("div",T,[y(x)])):(t(),o("div",N,[n.application!=null?(t(),o("div",A,[r("div",P,[r("h1",R,p(n.application.title),1)]),n.application.fields.length>0?(t(),o("div",O,[Y,r("section",j,[r("div",null,[z,n.schools.length<=0?(t(),b(V,{key:0},{default:F(()=>[G]),_:1})):u((t(),o("select",{key:1,"onUpdate:modelValue":s[1]||(s[1]=e=>n.selected_school=e),class:"block w-full py-2 px-3 pr-8 rounded-md bg-white border border-gray-400 focus:outline-none focus:shadow-outline-green focus:border-green-500 sm:text-sm sm:leading-5"},[(t(!0),o(m,null,f(n.schools,e=>(t(),o("option",{key:e.id,value:e.id},p(e.name),9,M))),128))],512)),[[w,n.selected_school]])])])])):d("",!0),n.application.fields.length>0?(t(),o("div",H,[J,r("div",K,[(t(!0),o(m,null,f(n.application.fields,(e,q)=>(t(),o("div",{key:e.id},[r("div",null,[r("label",{class:"block font-rubik mb-1",for:e.name},p(e.name),9,Q),e.type=="text"?u((t(),o("input",{key:0,class:"block w-full rounded-lg p-2 border border-gray-400 focus:outline-none focus:border-green-500",id:e.name,"onUpdate:modelValue":a=>e.answer=a,type:"text"},null,8,W)),[[k,e.answer]]):d("",!0),e.type=="email"?u((t(),o("input",{key:1,class:"block w-full rounded-lg p-2 border border-gray-400 focus:outline-none focus:border-green-500",id:e.name,"onUpdate:modelValue":a=>e.answer=a,type:"email"},null,8,X)),[[k,e.answer]]):d("",!0),e.type=="number"?u((t(),o("input",{key:2,class:"block w-full rounded-lg p-2 border border-gray-400 focus:outline-none focus:border-green-500",id:e.name,"onUpdate:modelValue":a=>e.answer=a,type:"text"},null,8,Z)),[[k,e.answer]]):d("",!0),e.type=="textarea"?u((t(),o("textarea",{key:3,id:e.name,"onUpdate:modelValue":a=>e.answer=a,name:"description",class:"block w-full rounded-lg p-2 border border-gray-400 focus:outline-none focus:border-green-500"},null,8,$)),[[k,e.answer]]):d("",!0),e.type=="select"?(t(),o("div",ee,[e.is_processing?(t(),b(E,{key:0})):(t(),o("div",se,[e.collection_for_select=="users"?u((t(),o("select",{key:0,class:"block w-full py-2 px-3 pr-8 rounded-md bg-white border border-gray-400 focus:outline-none focus:shadow-outline-green focus:border-green-500 sm:text-sm sm:leading-5",id:e.name,"onUpdate:modelValue":a=>e.answer=a},[(t(!0),o(m,null,f(e.data,a=>(t(),o("option",{key:a.id,value:a.id},p(a.first_name)+" "+p(a.last_name),9,oe))),128))],8,te)),[[w,e.answer]]):d("",!0),e.collection_for_select=="departments"?u((t(),o("select",{key:1,class:"block w-full py-2 px-3 pr-8 rounded-md bg-white border border-gray-400 focus:outline-none focus:shadow-outline-green focus:border-green-500 sm:text-sm sm:leading-5",id:e.name,"onUpdate:modelValue":a=>e.answer=a},[(t(!0),o(m,null,f(e.data,a=>(t(),o("option",{key:a.id,value:a.id},p(a.name),9,ie))),128))],8,ae)),[[w,e.answer]]):d("",!0),e.collection_for_select=="schools"?u((t(),o("select",{key:2,class:"block w-full py-2 px-3 pr-8 rounded-md bg-white border border-gray-400 focus:outline-none focus:shadow-outline-green focus:border-green-500 sm:text-sm sm:leading-5",id:e.name+e.id,"onUpdate:modelValue":a=>e.answer=a},[(t(!0),o(m,null,f(e.data,a=>(t(),o("option",{key:a.id,value:a.id},p(a.name),9,ne))),128))],8,le)),[[w,e.answer]]):d("",!0)]))])):d("",!0)]),n.validationError&&n.validationError[`answers.${q}.answer`]?(t(),o("p",re,p(n.validationError["answers."+q+".answer"][0]),1)):d("",!0)]))),128))])])):d("",!0),n.application.requirements.length>0?(t(),o("div",ce,[de,r("div",pe,[(t(!0),o(m,null,f(n.application.requirements,e=>(t(),o("div",{key:e.id,class:""},[r("label",{class:"block font-bold text-gray-700",for:e.name},p(e.name),9,he),r("span",ue,p(e.file_type)+" | ",1),r("span",_e,p(e.upload_type),1),y(B,{label:"Drag & Drop your  files here or <u>Browse</u>",multiple:e.upload_type!="single-upload",fileType:e.file_type=="documents"?i.fileType.documents:i.fileType.image,onFileIsUploading:e.handleLoading,onFileIsUploaded:e.setFile,onFileIsDeleted:e.removeFile,class:"mt-2 tex-sm"},null,8,["multiple","fileType","onFileIsUploading","onFileIsUploaded","onFileIsDeleted"])]))),128))])])):d("",!0),r("div",me,[r("div",fe,[r("div",ge,[y(U,{mode:"",class:"mr-2",onClick:s[2]||(s[2]=e=>this.$router.back())},{default:F(()=>[ye]),_:1}),r("div",null,[n.isSaving?(t(),b(C,{key:0,class:"mx-2"})):(t(),b(U,{key:1,class:"",onClick:h.submitData},{default:F(()=>[be]),_:1},8,["onClick"]))])])])])])):d("",!0)]))])}const ve=D(L,[["render",we]]);export{ve as default};
