import{_ as v,s as b,x as _,c,b as e,h as k,y as S,d as a,k as U,F as B,i as C,g as d,w as h,T as p,r as u,o,t as x,p as L,q as I,e as w}from"./app.0b9d15e2.js";const T={created(){this.getUserDetails(),this.loadSchool()},computed:{...b(["User"])},data(){return{schools:[],showLogoutButton:!1,isFetching:!1,isLogout:!1,isSaving:!1,selectedSchool:null}},methods:{async attachSchoolToUser(){this.isSaving=!0,await _.post("api/schools/attach-to-user",{school:this.selectedSchool}).then(s=>{window.location.reload(!0),console.log(s)}).catch(s=>{console.log(s)}).finally(()=>{this.isSaving=!1})},selectSchool(s){const t=s;this.selectedSchool=t},checkUserAccount(){this.User.hasRoleOf(["sbo-student","sbo-adviser","guest"])&&this.User.schools.length>0&&this.$router.push({name:"dashboard"})},async getUserDetails(){localStorage.getItem("token")!=null&&(this.$store.state.User==null?(this.isScreenLoading=!0,this.$store.dispatch("getUser").then(t=>{this.$store.commit("setUser",t),console.log("from fetch"),this.checkUserAccount()}).catch(t=>{this.requestError=t,this.$store.dispatch("logoutUser")}).finally(()=>{this.isScreenLoading=!1})):this.checkUserAccount())},async logoutUser(){this.isLogout=!0,await _.post("api/logout").then(s=>{localStorage.removeItem("token"),window.location.reload(!0)}).catch(s=>{s.response.status==401&&(localStorage.removeItem("token"),window.location.reload(!0)),this.requestError={statusCode:String(s.response.status),message:s.response.statusText},localStorage.removeItem("token"),window.location.reload(!0)}).finally(()=>{this.isLogout=!1})},async loadSchool(){this.isFetching=!0,await _.get("api/schools").then(s=>{console.log(s.data),this.schools=s.data.data}).catch(s=>{console.log(s)}).finally(()=>{this.isFetching=!1})}}},l=s=>(L("data-v-ba0c8910"),s=s(),I(),s),j={class:"sticky top-0 z-10 flex h-16 flex-shrink-0 bg-white shadow"},A=l(()=>e("button",{type:"button",class:"border-r border-gray-200 px-4 text-gray-500 focus:outline-none focus:ring-2 focus:ring-inset focus:ring-indigo-500 md:hidden"},[e("span",{class:"sr-only"},"Open sidebar"),e("svg",{class:"h-6 w-6",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M3.75 6.75h16.5M3.75 12h16.5m-16.5 5.25H12"})])],-1)),D={class:"flex flex-1 justify-between px-4"},F=l(()=>e("div",{class:"flex flex-1"},null,-1)),V={class:"ml-4 flex items-center md:ml-6"},q=l(()=>e("button",{type:"button",class:"rounded-full bg-white p-1 text-gray-400 hover:text-gray-500 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2"},[e("span",{class:"sr-only"},"View notifications"),e("svg",{class:"h-6 w-6",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M14.857 17.082a23.848 23.848 0 005.454-1.31A8.967 8.967 0 0118 9.75v-.7V9A6 6 0 006 9v.75a8.967 8.967 0 01-2.312 6.022c1.733.64 3.56 1.085 5.455 1.31m5.714 0a24.255 24.255 0 01-5.714 0m5.714 0a3 3 0 11-5.714 0"})])],-1)),M={class:"relative ml-3"},E=l(()=>e("span",{class:"sr-only"},"Open user menu",-1)),N=l(()=>e("img",{class:"h-8 w-8 rounded-full",src:"https://images.unsplash.com/photo-1472099645785-5658abf4ff4e?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=facearea&facepad=2&w=256&h=256&q=80",alt:""},null,-1)),O=[E,N],G={class:"absolute right-0 z-10 mt-2 w-48 origin-top-right rounded-md bg-white py-1 shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none",role:"menu","aria-orientation":"vertical","aria-labelledby":"user-menu-button",tabindex:"-1"},z={key:0,class:"flex justify-center items-center h-screen"},H={key:1,class:"m-7"},R={key:0,class:"my-3"},W=l(()=>e("h1",{class:"text-4xl font-bold"},"What University Are You In?",-1)),J=[W],Q={role:"list",class:"grid grid-cols-1 gap-6 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4"},Y=["onClick"],K={class:"flex flex-1 flex-col p-8"},P={key:0},X=["src"],Z={key:1},$=["src"],ee={class:"mt-1 flex flex-grow flex-col justify-between"},se=l(()=>e("dt",{class:"sr-only"},"Title",-1)),te=l(()=>e("dt",{class:"sr-only"},"Role",-1)),oe={class:"mt-3"},ne={class:"rounded-full bg-green-100 px-2 py-1 text-xs font-medium text-green-800"},ie={class:"text-lg font-extrabold mb-1"},le=l(()=>e("span",{class:"text-sm text-gray-600"}," Make sure to select school that you belong. If you think you made mistake you can request to the admin ",-1)),ce={class:"flex"},ae=w("Close "),re=w(" Confirm University "),de={class:"flex justify-center items-center"},he=l(()=>e("p",{class:"text-lg"},"Signing out...",-1));function ue(s,t,ge,_e,n,r){const g=u("BaseSpinner"),y=u("w-divider"),f=u("TableButton"),m=u("BaseDialog");return o(),c("main",null,[e("div",j,[A,e("div",D,[F,e("div",V,[q,e("div",M,[e("div",null,[e("button",{onClick:t[0]||(t[0]=i=>n.showLogoutButton=!n.showLogoutButton),type:"button",class:"flex max-w-xs items-center rounded-full bg-white text-sm focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2",id:"user-menu-button","aria-expanded":"false","aria-haspopup":"true"},O)]),k(e("div",G,[e("button",{onClick:t[1]||(t[1]=(...i)=>r.logoutUser&&r.logoutUser(...i)),class:"block px-4 py-2 text-sm text-gray-700",role:"menuitem",tabindex:"-1",id:"user-menu-item-2"}," Sign out ")],512),[[S,n.showLogoutButton]])])])])]),n.isFetching?(o(),c("div",z,[a(g)])):(o(),c("div",H,[n.schools.length>0?(o(),c("div",R,J)):U("",!0),e("ul",Q,[(o(!0),c(B,null,C(n.schools,i=>(o(),c("li",{onClick:fe=>r.selectSchool(i),key:i.id,class:"border border-grey-400 cursor-pointer hover:bg-green-50 hover:border col-span-1 flex flex-col divide-y divide-gray-200 rounded-lg bg-white text-center"},[e("div",K,[i.files.length>0?(o(),c("div",P,[e("img",{class:"mx-auto h-30 w-30 flex-shrink-0 rounded-xs",src:"/uploads/files/"+i.files[0].owned_by+"/"+i.files[0].folder+"/"+i.files[0].file_name,alt:""},null,8,X)])):(o(),c("div",Z,[e("img",{class:"mx-auto h-30 w-30 flex-shrink-0 rounded-xs",src:"/assets/undraw_welcome_re_h3d9.svg",alt:""},null,8,$)])),e("dl",ee,[se,te,e("dd",oe,[e("span",ne,x(i.name),1)])])])],8,Y))),128))])])),(o(),d(p,{to:"#app"},[a(m,{show:n.selectedSchool!=null,width:"500",preventClose:!0},{"c-content":h(()=>[e("p",ie,x(n.selectedSchool.name),1),a(y,{class:"mb-1"}),le,e("div",ce,[a(f,{onClick:t[2]||(t[2]=i=>n.selectedSchool=null),mode:"",class:"mt-4 mr-2"},{default:h(()=>[ae]),_:1}),n.isSaving?(o(),d(g,{key:0,class:"mx-4 mt-4"})):(o(),d(f,{key:1,onClick:r.attachSchoolToUser,class:"mt-4"},{default:h(()=>[re]),_:1},8,["onClick"]))])]),_:1},8,["show"])])),(o(),d(p,{to:"#app"},[a(m,{show:n.isLogout,width:"200"},{"c-content":h(()=>[e("div",de,[a(g,{class:"mx-2"}),he])]),_:1},8,["show"])]))])}const pe=v(T,[["render",ue],["__scopeId","data-v-ba0c8910"]]);export{pe as default};
