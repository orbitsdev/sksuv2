import{s as D,_ as V,o as t,c as s,b as n,d as _,t as p,F as g,i as y,h as v,A as T,k as u,g as $,v as C,e as F,w,r as m,x as q,T as I}from"./app.1c991082.js";const S={props:["data"],emits:["close","updated"],computed:{...D(["fileType"])},data(){return{application:{response_id:null,application_form_id:null,application_form_title:null,fields:[],requirements:[]},isSaving:!1,isFetching:!1,validationError:null,requestError:null}},created(){this.getApplicationForm()},methods:{async updateResponse(){this.isSaving=!0;let a=[],l=[];this.application.fields.forEach(r=>{let o={field_name:r.name,field_id:r.id,answer_id:r.answer_id,answer_value:r.answer};a.push(o)}),this.application.requirements.forEach(r=>{let o={requirement_id:r.id,response_requirement_id:r.response_requirement_id,files:r.files,fileToBeRemove:r.fileToBeRemove};l.push(o)});let d={response_id:this.application.response_id,application_form_id:this.application.application_form_id,application_form_title:this.application.application_form_title,fields:a,requirements:l};await axiosApi.post("api/application-form/response/update",d).then(r=>{this.validationError=null,this.$emit("updated")}).catch(r=>{r.response.status===422?this.validationError=r.response.data.errors:this.requestError=r}).finally(()=>{this.isSaving=!1})},getFileTypeData(a){if(a=="documents")return this.fileType.documents;if(a=="image")return this.fileType.image},removeExistingFile(a,l){const d=this.application.requirements[a].existingFile.find(r=>r.id==l);this.application.requirements[a].existingFile=this.application.requirements[a].existingFile.filter(r=>r.id!=l),this.application.requirements[a].fileToBeRemove.push(d)},async fetchDataForSelect(a){axios.all(a.map(l=>axios.get("/api/application-fields-for-select/fetch",{params:l}))).then(l=>{this.application.fields.forEach(d=>{if(d.type=="select"){let r=l.find(o=>o.data.field_id==d.id);d.id==r.data.field_id&&(d.data=r.data.data,d.is_processing=!1,d.data.length>0&&d.data.forEach(o=>{d.asnwer==o.name&&(d.answer=d.data[0].name)}))}})}).catch(l=>{})},async getApplicationForm(){const a=this.data;let l=[],d=[];a.answers.forEach(o=>{let c={...o.field,answer_id:o.id,answer:o.answer_value,data:null,is_processing:!0};if(o.field.type=="select"){let b={tablename:o.field.collection_for_select,field_id:o.field.id};d.push(b)}else c.is_processing=!1;l.push(c)}),l.sort(function(o,c){return o.index-c.index}),this.application.response_id=a.id,this.application.application_form_id=a.application_form.id,this.application.application_form_title=a.application_form.title,this.application.fields=l,this.fetchDataForSelect(d);let r=[];a.response_requirements.forEach((o,c)=>{let b={response_requirement_id:o.id,...o.requirement,files:[],existingFile:o.files,fileToBeRemove:[],isUploading:!1,isComplete:!1,isAdding:!1,handleLoading:f=>{this.application.requirements[c].isUploading=f},setFile:f=>{this.application.requirements[c].files.push(f)},removeFile:f=>{const k=f;this.application.requirements[c].files=this.application.requirements[c].files.filter(x=>x.folder!=k.folder)}};r.push(b)}),this.application.requirements=r}}},A={key:0},L={class:"h-80 flex justify-center items-center"},R={key:1},j={key:0},N={class:"text-lg font-extrabold leading-6"},P=n("p",{class:"mt-1 max-w-2xl text-sm font-bold uppercase"},"General Information",-1),G={key:0,class:""},M=["for"],z=["id","onUpdate:modelValue"],K=["id","onUpdate:modelValue"],H=["id","onUpdate:modelValue"],J=["id","onUpdate:modelValue"],O={key:4,class:"relative rounded-md shadow-sm"},Q={key:1},W=["id","onUpdate:modelValue"],X=["value"],Y=["id","onUpdate:modelValue"],Z=["value"],ee=["id","onUpdate:modelValue"],te=["value"],se={key:0,class:"text-xs text-red-500 mt-1"},oe={"v.if":"application.requirements.length > 0"},ne=n("p",{class:"mt-1 max-w-2xl text-sm font-bold uppercase"},"Requirement Attachment ",-1),ie={class:"block font-bold text-gray-700"},ae={class:"text-xs"},le={key:0,class:"text-xs"},re={key:0,class:"mb-2"},de={class:"py-1 flex flex-wrap"},ce={key:0},pe={key:1},ue=n("div",{class:"my-4"},null,-1),_e={class:"my-2 flex justify-end"},he=F(" Close "),me={key:0,class:"my-1 mx-2"},fe={key:1},ge=F(" Update ");function ye(a,l,d,r,o,c){const b=m("Loader1"),f=m("w-divider"),k=m("LinearLoader"),x=m("FileChip"),U=m("FilePondBase"),B=m("TableButton"),h=m("BaseSpinner");return o.isFetching?(t(),s("div",A,[n("div",L,[_(b)])])):(t(),s("div",R,[o.application.response_id!=null?(t(),s("div",j,[n("h3",N,p(o.application.application_form_title),1),P,_(f,{class:"my-1"}),o.application.fields.length>0?(t(),s("div",G,[(t(!0),s(g,null,y(o.application.fields,(e,E)=>(t(),s("div",{key:e.id,class:"mb-4"},[n("div",null,[n("label",{class:"block font-bold text-gray-700",for:e.name},p(e.name),9,M),e.type=="text"?v((t(),s("input",{key:0,class:"block w-full rounded-lg p-2 border border-gray-400 focus:outline-none focus:border-green-500",id:e.name,"onUpdate:modelValue":i=>e.answer=i,type:"text"},null,8,z)),[[T,e.answer]]):u("",!0),e.type=="email"?v((t(),s("input",{key:1,class:"block w-full rounded-lg p-2 border border-gray-400 focus:outline-none focus:border-green-500",id:e.name,"onUpdate:modelValue":i=>e.answer=i,type:"email"},null,8,K)),[[T,e.answer]]):u("",!0),e.type=="number"?v((t(),s("input",{key:2,class:"block w-full rounded-lg p-2 border border-gray-400 focus:outline-none focus:border-green-500",id:e.name,"onUpdate:modelValue":i=>e.answer=i,type:"text"},null,8,H)),[[T,e.answer]]):u("",!0),e.type=="textarea"?v((t(),s("textarea",{key:3,id:e.name,"onUpdate:modelValue":i=>e.answer=i,name:"description",class:"block w-full rounded-lg p-2 border border-gray-400 focus:outline-none focus:border-green-500"},null,8,J)),[[T,e.answer]]):u("",!0),e.type=="select"?(t(),s("div",O,[e.is_processing?(t(),$(k,{key:0})):(t(),s("div",Q,[e.collection_for_select=="users"?v((t(),s("select",{key:0,class:"block w-full py-2 px-3 pr-8 rounded-md bg-white border border-gray-400 focus:outline-none focus:shadow-outline-green focus:border-green-500 sm:text-sm sm:leading-5",id:e.name,"onUpdate:modelValue":i=>e.answer=i},[(t(!0),s(g,null,y(e.data,i=>(t(),s("option",{key:i.id,value:i.id},p(i.first_name)+" "+p(i.last_name),9,X))),128))],8,W)),[[C,e.answer]]):u("",!0),e.collection_for_select=="departments"?v((t(),s("select",{key:1,class:"block w-full py-2 px-3 pr-8 rounded-md bg-white border border-gray-400 focus:outline-none focus:shadow-outline-green focus:border-green-500 sm:text-sm sm:leading-5",id:e.name,"onUpdate:modelValue":i=>e.answer=i},[(t(!0),s(g,null,y(e.data,i=>(t(),s("option",{key:i.id,value:i.name},p(i.name),9,Z))),128))],8,Y)),[[C,e.answer]]):u("",!0),e.collection_for_select=="schools"?v((t(),s("select",{key:2,class:"block w-full py-2 px-3 pr-8 rounded-md bg-white border border-gray-400 focus:outline-none focus:shadow-outline-green focus:border-green-500 sm:text-sm sm:leading-5",id:e.name+e.id,"onUpdate:modelValue":i=>e.answer=i},[(t(!0),s(g,null,y(e.data,i=>(t(),s("option",{key:i.id,value:i.id},p(i.name),9,te))),128))],8,ee)),[[C,e.answer]]):u("",!0)]))])):u("",!0)]),o.validationError&&o.validationError[`fields.${E}.answer_value`]?(t(),s("p",se,p(o.validationError["fields."+E+".answer_value"][0]),1)):u("",!0)]))),128))])):u("",!0),n("div",oe,[ne,_(f,{class:"my-1"}),(t(!0),s(g,null,y(o.application.requirements,(e,E)=>(t(),s("div",{key:e.id},[n("p",ie,[F(p(e.name)+" ",1),n("span",ae," ( "+p(e.upload_type)+" ) ",1),e.upload_type=="multiple-upload"?(t(),s("span",le," - Existing files ("+p(e.existingFile.length)+") ",1)):u("",!0)]),e.existingFile.length>0?(t(),s("div",re,[n("div",de,[(t(!0),s(g,null,y(e.existingFile,i=>(t(),$(x,{class:"mx-1 mb-1",key:i.id,onClick:Je=>c.removeExistingFile(E,i.id)},{default:w(()=>[F(p(i.file_name),1)]),_:2},1032,["onClick"]))),128))]),e.upload_type=="multiple-upload"?(t(),s("div",ce,[_(U,{label:"Drag & Drop your image here or <u> Browse </u>",multiple:e.upload_type!="single-upload",fileType:c.getFileTypeData(e.file_type),onFileIsUploading:e.handleLoading,onFileIsUploaded:e.setFile,onFileIsDeleted:e.removeFile,class:"mt-2"},null,8,["multiple","fileType","onFileIsUploading","onFileIsUploaded","onFileIsDeleted"])])):u("",!0)])):(t(),s("div",pe,[n("div",null,[_(U,{label:"Drag & Drop your image here or <u> Browse </u>",multiple:e.upload_type!="single-upload",fileType:c.getFileTypeData(e.file_type),onFileIsUploading:e.handleLoading,onFileIsUploaded:e.setFile,onFileIsDeleted:e.removeFile,class:"mt-2"},null,8,["multiple","fileType","onFileIsUploading","onFileIsUploaded","onFileIsDeleted"])])]))]))),128))]),ue,n("div",_e,[_(B,{mode:"",class:"mr-2",onClick:l[0]||(l[0]=e=>this.$emit("close"))},{default:w(()=>[he]),_:1}),o.isSaving?(t(),s("div",me,[_(h)])):(t(),s("div",fe,[_(B,{class:"",onClick:c.updateResponse},{default:w(()=>[ge]),_:1},8,["onClick"])]))])])):u("",!0)]))}const be=V(S,[["render",ye]]),ve={props:["id"],components:{EditApplication:be},data(){return{isFetching:!1,response:null,showForm:!1,isSaving:!1}},created(){this.getResponse()},methods:{handleUpdate(){this.showForm=!1,this.getResponse()},updateResponse(){console.log("yow")},showEditForm(){this.showEditForm=!0},async getResponse(){this.isFetching=!0,q.post("api/monitor/specific-response",{id:this.id}).then(a=>{a.data.data.answers.sort((l,d)=>l.field.index-d.field.index),this.response=a.data.data}).catch(a=>{console.log(a)}).finally(()=>{this.isFetching=!1})},async setInitialValueToForm(){}}},we={class:"flex mb-4 items-center justify-between"},ke={class:"text-2xl font-rubik font-bold text-green-700"},xe={key:0},Fe={class:"h-screen flex justify-center items-center"},Ue={key:1},Be={key:0,class:""},Ee={class:"flex justify-end"},Te=F(" Update "),Ce=n("i",{class:"ml-2 text-xs fa-solid fa-pencil"},null,-1),$e=n("section",{class:"px-3 bg-gray-300 pt-2 pb-4 rounded-lg mt-4"},[n("h1",{class:"text-lg font-bold font-rubik mb-2 uppercase"},"University"),n("p",{class:"block font-rubik"},"Sultan Kudarat Saye Univsersit")],-1),Ve={class:"px-3 bg-gray-300 pt-2 pb-4 rounded-lg mt-4"},De=n("h1",{class:"text-lg font-bold font-rubik mb-2 uppercase"},"General Information",-1),qe={class:"block font-rubik font-bold"},Ie={class:"block font-rubik"},Se={class:"px-3 bg-gray-300 pt-2 pb-4 rounded-lg mt-4"},Ae=n("h1",{class:"text-lg font-bold font-rubik mb-2 uppercase"},"Requirements",-1),Le={class:"block font-rubik font-bold mb-1"},Re={class:"mt-1 text-sm text-gray-900 sm:col-span-2 sm:mt-0"},je={key:0,class:"bg-gray-400 rounded-lg p-4"},Ne=["href"],Pe={class:"mb-0.5"},Ge={class:"flex flex-wrap items-center"},Me=n("svg",{class:"h-5 w-5 mr-1 text-white font-bold",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true"},[n("path",{"fill-rule":"evenodd",d:"M15.621 4.379a3 3 0 00-4.242 0l-7 7a3 3 0 004.241 4.243h.001l.497-.5a.75.75 0 011.064 1.057l-.498.501-.002.002a4.5 4.5 0 01-6.364-6.364l7-7a4.5 4.5 0 016.368 6.36l-3.455 3.553A2.625 2.625 0 119.52 9.52l3.45-3.451a.75.75 0 111.061 1.06l-3.45 3.451a1.125 1.125 0 001.587 1.595l3.454-3.553a3 3 0 000-4.242z","clip-rule":"evenodd"})],-1),ze={class:"font-rubik text-white"},Ke={key:1,class:"inline-block font-rubik p-1 rounded-lg"};function He(a,l,d,r,o,c){const b=m("BackCard"),f=m("Loader1"),k=m("TableButton"),x=m("FormParentCard"),U=m("EditApplication"),B=m("BaseDialog");return t(),s("div",null,[n("div",we,[_(b,{class:"",onClick:l[0]||(l[0]=h=>this.$router.back())}),n("p",ke,p(a.page),1)]),o.isFetching?(t(),s("div",xe,[n("div",Fe,[_(f)])])):(t(),s("div",Ue,[o.response!=null?(t(),s("div",Be,[_(x,{title:o.response.application_form.title},{action:w(()=>[n("div",Ee,[_(k,{onClick:l[1]||(l[1]=h=>o.showForm=!0)},{default:w(()=>[Te,Ce]),_:1})])]),default:w(()=>[$e,n("section",Ve,[De,(t(!0),s(g,null,y(o.response.answers,h=>(t(),s("div",{class:"mb-2",key:h.id},[n("p",qe,p(h.field.name),1),n("p",Ie,p(h.answer_value),1)]))),128))]),n("section",Se,[Ae,(t(!0),s(g,null,y(o.response.response_requirements,h=>(t(),s("div",{class:"mb-2",key:h.id},[n("p",Le,p(h.requirement.name),1),n("dd",Re,[h.files.length>0?(t(),s("div",je,[(t(!0),s(g,null,y(h.files,e=>(t(),s("a",{href:e.url,class:"bg-gray-700 inline-block mr-2 my-2 cursor-pointer hover:scale-105 hover:bg-gray-900 transition-all ease-in-out p-2 rounded-lg",key:e.id},[n("div",Pe,[n("div",Ge,[Me,n("span",ze,p(e.file_name),1)])])],8,Ne))),128))])):(t(),s("div",Ke," No File "))])]))),128))])]),_:1},8,["title"])])):u("",!0)])),(t(),$(I,{to:"#app"},[_(B,{show:o.showForm,width:"600",preventClose:!0},{"c-content":w(()=>[_(U,{onClose:l[2]||(l[2]=h=>o.showForm=!1),onUpdated:c.handleUpdate,data:o.response},null,8,["onUpdated","data"])]),_:1},8,["show"])]))])}const Qe=V(ve,[["render",He]]);export{Qe as default};
