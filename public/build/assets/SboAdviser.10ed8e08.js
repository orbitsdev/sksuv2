import{_ as R,x as d,g as m,w as i,r as a,o as l,d as n,e as p,t as h,k as F,c,h as w,v as V,b as r,F as b,i as x,z as D,T as g}from"./app.bb9b3753.js";const T={data(){return{search:"",users:[],schools:[],selectedUsers:[],selectedUser:null,filterBy:"none",requestError:null,isSchoolFetching:!1,isFetching:!1,showConfirm:!1,isConfirming:!1,isRemoving:!1,show:!1}},created(){this.loadUser(),this.loadSchool()},watch:{search(e,t){this.searchUser()}},methods:{showSingleConfirmationRemoveRole(e){this.selectedUser=e,this.show=!0},async removeUserRole(){this.isConfirming=!0,await d.post("api/current-sbo-advisers/remove-sbo-adviser-role-to-user",{id:this.selectedUser.id}).then(e=>{this.show=!1,this.selectedUser=null,this.loadUser()}).catch(e=>{this.requestError=e}).finally(()=>{this.isConfirming=!1})},async removeRoleOfSelectedUsers(){const e=[];this.selectedUsers.forEach(t=>{e.push(t.id)}),console.log(e),this.isRemoving=!0,await d.post("api/current-sbo-advisers/remove-sbo-adviser-role-to-the-selected-user",{userid:e}).then(t=>{this.selectedUsers=[],this.showConfirm=!1,this.loadUser()}).catch(t=>{this.requestError=t}).finally(()=>{this.isRemoving=!1})},async filterUser(){console.log(this.filterBy),await d.post("api/current-sbo-advisers/filter",{filter:this.filterBy}).then(e=>{console.log(e),this.users=e.data.data}).catch(e=>{this.requestError=e})},async searchUser(){await d.post("api/current-sbo-advisers/search",{search:this.search,filter:this.filterBy}).then(e=>{console.log(e.data),this.users=e.data.data})},async loadSchool(){this.isSchoolFetching=!0,await d.get("api/schools").then(e=>{this.schools=e.data.data}).catch(e=>{this.requestError=e}).finally(()=>{this.isSchoolFetching=!1})},async loadUser(){this.isFetching=!0,await d.get("api/current-sbo-advisers").then(e=>{console.log(e),this.users=e.data.data}).catch(e=>{this.requestError=e,console.log(e)}).finally(()=>{this.isFetching=!1})}},closeErrorDialog(){console.log("dasdsa"),this.requestError=null},async searchUser(){console.log(this.search),await d.post("api/current-sbo-advisers/search",{search:this.search,filter:this.filterBy}).then(e=>{this.users=e.data.data})}},N={key:0},A={key:1},O=r("option",{value:"none"},"None",-1),j=["value"],M={class:"relative w-12 px-6 sm:w-16 sm:px-8"},I=["value"],Y={class:"whitespace-nowrap py-4 text-sm"},z={class:"flex items-center"},H=r("div",{class:"h-10 w-10 flex-shrink-0"},[r("img",{class:"h-10 w-10 rounded-full",src:"https://images.unsplash.com/photo-1517841905240-472988babdf9?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=facearea&facepad=2&w=256&h=256&q=80",alt:""})],-1),J={class:"ml-4"},L={class:"font-medium text-gray-900"},Q={class:"text-gray-900"},W={class:"whitespace-nowrap px-3 py-4 text-sm text-gray-500"},G={key:0},K={key:1},P=r("span",null,[r("span",{class:"inline-flex rounded-full bg-green-100 px-2 text-xs font-semibold leading-5 text-green-800"},"None")],-1),X=[P],Z=r("td",{class:"whitespace-nowrap px-3 py-4 text-sm text-gray-500"},null,-1),$={class:"relative whitespace-nowrap py-4 pl-3 pr-4 text-right text-sm font-medium sm:pr-6"},ee=["onClick","disabled"],se=r("i",{class:"fa-regular fa-pen-to-square"},null,-1),te=[se],oe=p(" Yes "),re={class:"bg-gray-100 text-xs italic p-1 my-1 rounded-sm"},ie={key:0},le={key:1},ne=p(" Yes ");function ae(e,t,ce,he,s,u){const f=a("TableButton"),U=a("BaseSearchInput"),C=a("BaseSpinner"),B=a("BaseTableSetup"),S=a("BaseTable"),_=a("BaseConfirmation"),v=a("BaseDialog"),k=a("RequestError"),E=a("BaseErrorDialog"),q=a("BaseCard");return l(),m(q,{subtitle:"SBO Advisers"},{header:i(()=>[n(B,null,{"searchs-area":i(()=>[s.selectedUsers.length>0?(l(),m(f,{key:0,onClick:t[0]||(t[0]=o=>s.showConfirm=!0),class:"mr-2"},{default:i(()=>[p(" Remove sbo adviser ("+h(s.selectedUsers.length)+") ",1)]),_:1})):F("",!0),n(U,{placeholder:"Search Name ...",modelValue:s.search,"onUpdate:modelValue":t[1]||(t[1]=o=>s.search=o)},null,8,["placeholder","modelValue"])]),"filters-area":i(()=>[s.isSchoolFetching?(l(),c("div",N,[n(C)])):(l(),c("div",A,[w(r("select",{"onUpdate:modelValue":t[2]||(t[2]=o=>s.filterBy=o),onChange:t[3]||(t[3]=(...o)=>u.filterUser&&u.filterUser(...o)),class:"block hover:shadow-lg border px-3 py-2 text-gray-600 placeholder-gray-500 focus:border-gray-300 focus:placeholder-gray-400 focus:outline-none sm:text-sm"},[O,(l(!0),c(b,null,x(s.schools,o=>(l(),c("option",{key:o.id,class:"py-2",value:o.name},h(o.name),9,j))),128))],544),[[V,s.filterBy]])]))]),"actions-area":i(()=>[]),_:1})]),default:i(()=>[n(S,{thdata:["","Name","University",""],isFetching:s.isFetching},{data:i(()=>[(l(!0),c(b,null,x(s.users,o=>(l(),c("tr",{key:o.id},[r("td",M,[w(r("input",{"onUpdate:modelValue":t[4]||(t[4]=y=>s.selectedUsers=y),value:o,type:"checkbox",class:"absolute left-4 top-1/2 -mt-2 h-4 w-4 rounded border-gray-300 text-indigo-600 focus:ring-indigo-500 sm:left-6"},null,8,I),[[D,s.selectedUsers]])]),r("td",Y,[r("div",z,[H,r("div",J,[r("div",L,h(o.first_name+" "+o.last_name),1),r("div",Q,h(o.email),1)])])]),r("td",W,[o.schools.length>0?(l(),c("div",G,[r("span",null,h(o.schools[0].name),1)])):(l(),c("div",K,X))]),Z,r("td",$,[r("button",{onClick:y=>u.showSingleConfirmationRemoveRole(o),disabled:s.selectedUsers.length>0,type:"button",class:"inline-flex items-center rounded-md border outline:none border-gray-300 bg-white px-3 py-2 text-sm font-medium leading-4 text-gray-700 shadow-sm hover:bg-gray-50 focus:outline-none focus:ring-1 disabled:cursor-not-allowed disabled:opacity-30 mr-1"},te,8,ee)])]))),128))]),_:1},8,["isFetching"]),(l(),m(g,{to:"#app"},[n(v,{show:s.showConfirm,width:"500",preventClose:!0},{"c-content":i(()=>[n(_,{selectedData:s.selectedUsers,onClose:t[5]||(t[5]=o=>s.showConfirm=!1),isSaving:s.isRemoving,title:"Are you sure do you want to remove the following users as ",subject:"SBO Adviser?"},{default:i(()=>[n(f,{class:"mr-2",onClick:u.removeRoleOfSelectedUsers},{default:i(()=>[oe]),_:1},8,["onClick"])]),_:1},8,["selectedData","isSaving"])]),_:1},8,["show"])])),(l(),m(g,{to:"#app"},[n(v,{show:s.show,width:"500",preventClose:!0},{"c-content":i(()=>[n(_,{onClose:t[6]||(t[6]=o=>s.show=!1),isSaving:s.isConfirming,title:"Are your sure do you want to make this users as ",subject:"Sbo-Adviser"},{data:i(()=>[r("div",re,[p(h(s.selectedUser.first_name)+" "+h(s.selectedUser.last_name)+" - ",1),s.selectedUser.schools!=null&&s.selectedUser.schools.length>0?(l(),c("span",ie,h(s.selectedUser.schools[0].name),1)):(l(),c("span",le," Unknown "))])]),default:i(()=>[n(f,{class:"mr-2",onClick:u.removeUserRole},{default:i(()=>[ne]),_:1},8,["onClick"])]),_:1},8,["isSaving"])]),_:1},8,["show"])])),(l(),m(g,{to:"#app"},[n(E,{show:s.requestError!=null,width:"400",transition:"slide-fade-down"},{"c-content":i(()=>[n(k,{statusCode:s.requestError.statusCode,onClose:t[7]||(t[7]=o=>s.requestError=null),message:s.requestError.message},null,8,["statusCode","message"])]),"c-actions":i(()=>[]),_:1},8,["show"])]))]),_:1})}const ue=R(T,[["render",ae]]);export{ue as default};
