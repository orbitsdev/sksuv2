import{_ as I,s as z,x as _,c as a,b as o,d as r,w as l,F as y,r as u,o as i,g as f,e as d,t as c,k as v,i as b,h as w,z as q,v as k,T as E,p as N,q as T}from"./app.bb9b3753.js";const G={computed:{schoolYearId(){return this.$route.params.id}},data(){return{search:"",isSaving:!1,isFetching:!1,isStudentFetching:!1,showForm:!1,requestError:null,validationError:{},officers:[],studentoptions:[],departments:[],position:[],selectedStudent:null,selectedDepartment:null,selectedPosition:null,selectedOfficer:null,selectedOfficers:[],isUpdatingMode:!1,showDeleteConfirmation:!1,isConfirming:!1,isFetchingParent:!1,isOfficerFetching:!1,hasWarning:null}},created(){this.getOfficers(),this.getStudent(),this.loadDepartment(),this.position=[{id:1,name:"Governor",value:"Governor"},{id:2,name:"Vice Governor",value:"Vice Governor"},{id:3,name:"Board Member",value:"Board Member"}],this.selectedPosition=this.position[0]},computed:{...z(["User"])},methods:{async getSchool(){this.isFetchingParent=!0,await _.post("api/manage-officer/school-year-school",{school_year_id:this.$route.params.id}).then(n=>{this.schools=n.data.data}).catch(n=>{this.hasRequestError='"Oops! It seems like there was an error when fetching school campuse adviser Please check your network connection. o and try again. if you think it it was the system please do contact the developer"'}).finally(()=>{this.isFetchingParent=!1})},async deleteSelectedOfficer(){this.isConfirming=!0,_.post("api/manage-officer/delete-selected-officer",{officers:this.selectedOfficers}).then(n=>{console.log(n.data),this.getOfficers(),this.getStudent(),this.selectedOfficers=[],this.showDeleteConfirmation=!1}).catch(n=>{console.log(n)}).finally(()=>{this.isConfirming=!1})},handleShowForm(n,t){this.showForm=!0,this.validationError={},n==null&&t=="add"&&(this.isUpdatingMode=!1,this.selectedOfficer=null),n!=null&&t=="update"&&(this.isUpdatingMode=!0,this.selectedOfficer=n)},async createOfficer(){this.isSaving=!0;let n=parseInt(this.$route.params.id);const t={student_id:this.selectedStudent,position:this.selectedPosition.name,department_id:this.selectedDepartment,school_id:n};await _.post("api/manage-officer/create-officer",t).then(h=>{h.data.data===1?this.hasWarning='" A user with this name already exists. Please try a different one"':(this.showForm=!1,this.getStudent(),this.getOfficers())}).catch(h=>{h.response.status===422?this.validationError=h.response.data.errors:this.requestError=h}).finally(()=>{this.isSaving=!1})},async updateOfficer(){let n=parseInt(this.$route.params.id);const t={officer_id:this.selectedOfficer.id,position:this.selectedPosition.name,department_id:this.selectedDepartment,school_id:n,student_id:this.selectedOfficer.student.id};console.log(t),await _.post("api/manage-officer/update-officer",t).then(h=>{console.log(h.data),this.getOfficers(),this.getStudent(),this.selectedOfficers=[],this.showDeleteConfirmation=!1,this.isUpdatingMode=!1,this.showForm=!1,this.selectedOfficer=null}).catch(h=>{h.response.status===422?this.validationError=h.response.data.errors:this.requestError=h}).finally(()=>{this.isSaving=!1})},async loadDepartment(){this.isFetching=!0;let n=parseInt(this.$route.params.id);await _.post("api/manage-officer/get-school-department",{school_id:n}).then(t=>{this.departments=t.data.data,this.departments.length>0&&(this.selectedDepartment=this.departments[0].id)}).catch(t=>{this.requestError=t}).finally(()=>{this.isFetching=!1})},async getStudent(){this.isStudentFetching=!0;let n=parseInt(this.$route.params.id);await _.post("api/manage-officer/get-students",{school_id:n}).then(t=>{this.studentoptions=t.data.data,this.studentoptions.length>0&&(this.selectedStudent=this.studentoptions[0].id)}).catch(t=>{this.requestError=t,console.log(t)}).finally(()=>{this.isStudentFetching=!1})},async getOfficers(){this.isOfficerFetching=!0,await _.post("api/manage-officer/get-officers",{school_id:this.$route.params.id}).then(n=>{this.officers=n.data.data}).catch(n=>{this.requestError=n}).finally(()=>{this.isOfficerFetching=!1})}}},p=n=>(N("data-v-bb486885"),n=n(),T(),n),W={class:""},A=p(()=>o("i",{class:"fa-solid fa-plus mr-1"},null,-1)),j=d(" Add Officer "),Y=p(()=>o("i",{class:"fa-regular fa-trash-can mr-2"},null,-1)),L={class:"relative w-12 px-6 sm:w-16 sm:px-8"},R=["value"],H={class:"whitespace-nowrap px-3 py-4 text-sm"},J={class:"capitalize"},K={class:"whitespace-nowrap py-4"},Q={class:"capitalize"},X={class:"whitespace-nowrap py-4 text-sm text-gray-900"},Z=d(" None "),$={class:"relative whitespace-nowrap py-4 pl-3 pr-4 text-right text-sm font-medium sm:pr-6"},ee={class:"whitespace-normal py-2 text-sm text-gray-500"},te=["disabled","onClick"],se=p(()=>o("i",{class:"fa-regular fa-pen-to-square"},null,-1)),oe=[se],ie={key:0,class:"mb-4"},ne=p(()=>o("label",{class:"block font-bold mb-2 text-gray-700 capitalize"},[d("Choose Student from: "),o("span",{class:"inline-flex rounded-full bg-green-100 px-2 text-xs font-semibold leading-5 text-green-800 m-0.5"})],-1)),ae=d("Empty "),le=["value"],re={key:0,class:"text-xs mx-1 text-red-500 mt-1"},de={class:"mb-4"},ce=p(()=>o("label",{class:"block font-bold mb-2 text-gray-700 capitalize"},"Choose Sbo position ",-1)),he=d("Empty "),ue=["value"],fe={key:0,class:"text-xs mx-1 text-red-500 mt-1"},pe={class:"mb-4"},me=p(()=>o("label",{class:"block font-bold mb-2 text-gray-700 capitalize"},"Choose Organization ",-1)),_e=d("Empty "),ge=["value"],ye={class:"capitalize"},ve={key:0,class:"text-xs mx-1 text-red-500 mt-1"},be=p(()=>o("div",{class:"my-4"},null,-1)),we={class:"my-2 flex justify-end"},xe=d(" Close "),ke={key:0,class:"my-1 mx-2"},Ce={key:1},Se=d(" Update "),Oe=d(" Save "),Fe=p(()=>o("div",{class:"mb-4"},[o("p",{class:"font-bold text-lg"}," Are you sure do you want to delete selected officers? "),o("div",{class:"my-10 flex justify-center"},[o("img",{src:"/assets/undraw_throw_away_re_x60k.svg",width:"200",height:"200"})])],-1)),Ee=p(()=>o("div",{class:"my-4"},null,-1)),Be={class:"my-2 flex justify-end"},De=d(" Close "),Pe={key:0,class:"my-1 mx-2"},Me={key:1},Ue=d(" Yes ");function Ve(n,t,h,Ie,e,g){const B=u("BackCard"),m=u("TableButton"),D=u("BaseSearchInput"),P=u("BaseTableSetup"),C=u("StatusCard"),M=u("BaseTable"),x=u("NoDataCard"),S=u("BaseSpinner"),O=u("BaseDialog"),U=u("GlobalWarning"),V=u("BaseCard");return i(),a(y,null,[o("div",W,[r(B,{class:"mb-4",onClick:t[0]||(t[0]=s=>this.$router.back())})]),r(V,{subtitle:"Manage Officer"},{header:l(()=>[r(P,null,{"searchs-area":l(()=>[r(m,{class:"mr-2",onClick:t[1]||(t[1]=s=>g.handleShowForm(null,"add"))},{default:l(()=>[A,j]),_:1}),r(D,{placeholder:"Search Name ...",modelValue:e.search,"onUpdate:modelValue":t[2]||(t[2]=s=>e.search=s)},null,8,["placeholder","modelValue"])]),"actions-area":l(()=>[e.selectedOfficers.length>0?(i(),f(m,{key:0,onClick:t[3]||(t[3]=s=>e.showDeleteConfirmation=!0),mode:!0,class:"mr-2"},{default:l(()=>[Y,d(" Delete ( "+c(this.selectedOfficers.length)+" ) ",1)]),_:1})):v("",!0)]),_:1}),r(M,{thdata:["","Name","Position","Organization",""],isFetching:e.isOfficerFetching},{data:l(()=>[(i(!0),a(y,null,b(e.officers,s=>(i(),a("tr",{key:s.id},[o("td",L,[w(o("input",{"onUpdate:modelValue":t[4]||(t[4]=F=>e.selectedOfficers=F),value:s.id,type:"checkbox",class:"absolute left-4 top-1/2 -mt-2 h-4 w-4 accent-green-600 text-white rounded border-gray-200 sm:left-6"},null,8,R),[[q,e.selectedOfficers]])]),o("td",H,[o("p",J,c(s.student.first_name)+" "+c(s.student.last_name),1)]),o("td",K,[o("p",Q,c(s.position),1)]),o("td",X,[s.department!=null?(i(),f(C,{key:0,class:"bg-green-100 text-green-700"},{default:l(()=>[d(c(s.department.name),1)]),_:2},1024)):(i(),f(C,{key:1,class:"bg-gray-700 text-white"},{default:l(()=>[Z]),_:1}))]),o("td",$,[o("td",ee,[o("button",{disabled:e.selectedOfficers.length>0,onClick:F=>g.handleShowForm(s,"update"),type:"button",class:"inline-flex items-center rounded-md border outline:none border-gray-300 bg-white px-3 py-2 text-sm font-medium leading-4 text-gray-700 shadow-sm hover:bg-gray-50 focus:outline-none focus:ring-1 disabled:cursor-not-allowed disabled:opacity-30 mr-1"},oe,8,te)])])]))),128))]),_:1},8,["isFetching"])]),default:l(()=>[(i(),f(E,{to:"#app"},[r(O,{show:e.showForm,width:"500",preventClose:!0},{"c-content":l(()=>[o("div",null,[e.isUpdatingMode==!1?(i(),a("div",ie,[o("div",null,[ne,e.studentoptions.length<0?(i(),f(x,{key:0},{default:l(()=>[ae]),_:1})):w((i(),a("select",{key:1,"onUpdate:modelValue":t[5]||(t[5]=s=>e.selectedStudent=s),class:"block w-full py-2 px-3 pr-8 rounded-md bg-white border border-gray-400 focus:outline-none focus:shadow-outline-gray focus:border-gray-300 sm:text-sm sm:leading-5"},[(i(!0),a(y,null,b(e.studentoptions,s=>(i(),a("option",{key:s.id,value:s.id},c(s.first_name)+" "+c(s.last_name),9,le))),128))],512)),[[k,e.selectedStudent]])]),e.validationError!=null&&e.validationError.student_id?(i(),a("p",re,c(e.validationError.student_id[0]),1)):v("",!0)])):v("",!0),o("div",de,[o("div",null,[ce,e.position.length<=0?(i(),f(x,{key:0},{default:l(()=>[he]),_:1})):w((i(),a("select",{key:1,"onUpdate:modelValue":t[6]||(t[6]=s=>e.selectedPosition=s),class:"block w-full py-2 px-3 pr-8 rounded-md bg-white border border-gray-400 focus:outline-none focus:shadow-outline-gray focus:border-gray-300 sm:text-sm sm:leading-5"},[(i(!0),a(y,null,b(e.position,s=>(i(),a("option",{key:s.id,value:s},c(s.name),9,ue))),128))],512)),[[k,e.selectedPosition]])]),e.validationError!=null&&e.validationError.position_name?(i(),a("p",fe,c(e.validationError.position[0]),1)):v("",!0)]),o("div",pe,[o("div",null,[me,e.departments.length<=0?(i(),f(x,{key:0},{default:l(()=>[_e]),_:1})):w((i(),a("select",{key:1,"onUpdate:modelValue":t[7]||(t[7]=s=>e.selectedDepartment=s),class:"block w-full py-2 px-3 pr-8 rounded-md bg-white border border-gray-400 focus:outline-none focus:shadow-outline-gray focus:border-gray-300 sm:text-sm sm:leading-5"},[(i(!0),a(y,null,b(e.departments,s=>(i(),a("option",{key:s.id,value:s.id,class:"capitalize"},[o("span",ye,c(s.name),1)],8,ge))),128))],512)),[[k,e.selectedDepartment]])]),e.validationError!=null&&e.validationError.department_id?(i(),a("p",ve,c(e.validationError.department_id[0]),1)):v("",!0)]),be,o("div",we,[r(m,{mode:"",class:"mr-2",onClick:t[8]||(t[8]=s=>e.showForm=!1)},{default:l(()=>[xe]),_:1}),e.isSaving?(i(),a("div",ke,[r(S)])):(i(),a("div",Ce,[e.isUpdatingMode?(i(),f(m,{key:0,onClick:g.updateOfficer,class:""},{default:l(()=>[Se]),_:1},8,["onClick"])):(i(),f(m,{key:1,onClick:g.createOfficer,class:""},{default:l(()=>[Oe]),_:1},8,["onClick"]))]))])])]),_:1},8,["show"])])),(i(),f(E,{to:"#app"},[r(O,{show:e.showDeleteConfirmation,width:"400"},{"c-content":l(()=>[Fe,Ee,o("div",Be,[r(m,{mode:"",class:"mr-2",onClick:t[9]||(t[9]=s=>e.showDeleteConfirmation=!1)},{default:l(()=>[De]),_:1}),e.isConfirming?(i(),a("div",Pe,[r(S)])):(i(),a("div",Me,[r(m,{class:"",onClick:g.deleteSelectedOfficer},{default:l(()=>[Ue]),_:1},8,["onClick"])]))])]),_:1},8,["show"])])),r(U,{onClose:t[10]||(t[10]=s=>e.hasWarning=null),show:e.hasWarning!=null},{default:l(()=>[d(c(e.hasWarning),1)]),_:1},8,["show"])]),_:1})],64)}const qe=I(G,[["render",Ve],["__scopeId","data-v-bb486885"]]);export{qe as default};
